# ⚡ ChargerNote - 充电记账

<p align="center">
  <img src="https://img.shields.io/badge/Platform-iOS%2016.0%2B-blue.svg" alt="Platform">
  <img src="https://img.shields.io/badge/Swift-5.9-orange.svg" alt="Swift">
  <img src="https://img.shields.io/badge/License-MIT-green.svg" alt="License">
  <img src="https://img.shields.io/badge/Version-1.0.0-brightgreen.svg" alt="Version">
</p>

一款专为新能源车主设计的充电费用记账iOS应用，帮助您轻松管理充电开支、统计分析充电数据。

## ✨ 核心功能

### 📸 智能识别
- **截图OCR识别**：支持主流充电平台（小鹏、特斯拉、国家电网等）
- **双算法智能切换**：自动识别不同格式的充电订单截图
- **自动提取信息**：电费、服务费、充电度数、充电时间、优惠信息等

### 💰 多维度记账
- **充电记录**：完整记录每次充电的费用明细
- **电卡充值**：支持极能电卡等多平台电卡管理
- **优惠管理**：积分、优惠券、极能抵扣自动计算
- **电卡余额**：实时显示电卡余额，充值消耗一目了然

### 📊 数据统计
- **时间维度**：周/月/年三种时间范围，使用自然周期
- **趋势分析**：支出趋势图、充电度数趋势图
- **核心指标**：总支出、充电度数、电卡余额
- **详细统计**：充电次数、积分支出、平均电费、电卡消耗
- **地点分布**：按充电站点统计消费分布

### 📅 历史记录
- **时间轴展示**：按日期分组，清晰展示充电历史
- **快速操作**：左滑编辑/删除，点击查看详情
- **月度统计**：每月总支出、充电次数、平均度数
- **类型标识**：充电/充值记录区分显示

### 🛠️ 数据管理
- **CSV导出**：导出完整充电记录，方便Excel分析
- **iCloud备份**：支持备份和恢复所有数据
- **充电站管理**：自定义充电站点，拖拽排序
- **多货币支持**：人民币/美元/欧元切换
- **双语支持**：中文/English

## 🎨 设计特色

### iOS原生设计
- 严格遵循Apple Human Interface Guidelines
- 完美适配浅色/深色模式
- 流畅的动画和过渡效果
- 直观的手势操作

### 视觉优化
- 清新的绿色主题，符合环保充电理念
- 卡片式布局，信息层次分明
- 图表可视化，数据一目了然
- 精心设计的App图标

## 🚀 技术栈

- **开发语言**: Swift 5.9
- **UI框架**: SwiftUI
- **数据持久化**: SwiftData
- **OCR识别**: Vision Framework
- **最低支持**: iOS 16.0+

## 📱 功能详解

### 1. 首页

**快速记录**
- 上传截图：自动OCR识别充电订单信息
- 手动输入：完整的表单输入，支持所有字段

**本月概览**
- 本月总支出
- 充电次数
- 充电度数

**今日记录**
- 显示今天的充电记录
- 快速查看详情

### 2. 手动输入界面

**记录类型**
- 充电：日常充电记录
- 充值：电卡充值记录（如极能电卡）

**基本信息**
- 充电站/充值平台
- 充电时间/购买时间
- 充电电量/获得度数

**费用明细**（充电模式）
- 电费
- 服务费
- 优惠金额
- 停车费
- 实付金额（自动计算：电费 + 服务费 - 优惠）

**充值模式**
- 充值金额
- 获得度数
- 自动计算单价（元/度）

**其他信息**
- 积分支出
- 极能抵扣（只读显示）
- 备注

**UI/UX优化**
- 数字输入替换原值，不追加
- 未输入显示"未输入"而非¥0.00
- 分组布局：基本信息/费用明细/其他信息
- 智能键盘：显示正在编辑的字段名
- 语义配色：优惠（绿色）、积分（橙色）、实付（蓝色）

### 3. 统计分析

**时间范围**
- 周：周一到周日（自然周）
- 月：1号到月末（自然月）
- 年：1月到12月（自然年）

**核心指标卡片**
- 支出：时间范围内总支出
- 充电度数：时间范围内充电总度数
- 电卡余额：全局余额（充值度数 - 使用度数）

**统计栏**
- 充电次数
- 积分支出
- 平均电费（元/度）

**趋势图**
- 支出趋势：按天/周/月展示
- 充电度数趋势：按天/周/月展示
- X轴自动排序（周一到周日，1月到12月）

**地点分布**
- 按充电站点统计总消费
- 显示充电次数
- 可视化进度条

### 4. 历史记录

**月度统计**
- 总支出
- 充电次数
- 平均度数

**时间轴展示**
- 按日期分组
- 显示每日总金额
- 充电/充值记录区分

**记录卡片**
- 充电记录：显示充电站、度数、费用
- 充值记录：绿色标签、+金额、单价
- 左滑操作：编辑/删除

### 5. 设置

**货币设置**
- 人民币 (¥)
- 美元 ($)
- 欧元 (€)

**语言设置**
- 中文
- English

**充电站管理**
- 添加/编辑/删除充电站
- 拖拽排序
- 自定义图标和颜色

**数据管理**
- 导出CSV：完整记录导出
- iCloud备份：备份所有数据（记录+站点+设置）
- iCloud恢复：从备份文件恢复

**危险操作**
- 删除所有数据（二次确认）

## 🔍 OCR识别说明

### 算法1：费用明细样式
适用于带"费用明细"的订单截图（如小鹏充电）

**识别字段**
- 电费、服务费
- 优惠券、极分抵扣、极能抵扣
- 积分使用
- 充电站名称
- 充电时间
- 实付金额

**特殊处理**
- 实付为0时，自动将未识别信息填入备注
- 优惠金额优先级：极能 > 极分 > 优惠券
- 极能抵扣提取度数和金额

### 算法2：订单详情样式
适用于带"订单详情"的订单截图

**识别字段**
- 实付金额/订单总金额
- 电费和服务费（从费用明细行提取）
- 充电站点（多种策略匹配）
- 充电时间（四种格式支持）

**智能切换**
系统自动检测截图格式，选择最合适的算法

## 💾 数据管理

### CSV导出格式
```
日期,充电地点,记录类型,充电度数(kWh),电费金额,服务费,总金额,停车费,优惠金额,积分,极能度数(kWh),备注
2025-10-28 10:30:00,小鹏超充站,充电,29.8,19.12,10.73,29.85,0.00,0.00,0,0.000,无
2025-10-27 14:20:00,特斯拉超充,充值,300.0,309.00,0.00,309.00,0.00,0.00,0,0.000,极能电卡
```

### iCloud备份格式
JSON格式，包含：
- 充电记录（所有字段）
- 充电站点分类（名称、颜色、图标、排序）
- 用户设置（货币、语言）
- 版本信息和时间戳

### 备份文件命名
```
充电记账_20251028_143025.json
ChargerNote_20251028_143025.json
```

## 📖 使用技巧

### 快速记录
1. 充电完成后，截取订单截图
2. 打开App，点击"📸 上传截图"
3. 系统自动识别并填充
4. 确认无误后点击"完成"

### 电卡管理
1. 购买电卡时选择"充值"类型
2. 填写充值金额和获得度数（如309元=300度）
3. 使用电卡充电时，"极能抵扣"会自动识别
4. 统计页面实时显示电卡余额

### 数据分析
1. 统计页面查看总体趋势
2. 切换周/月/年查看不同时间范围
3. 查看地点分布，了解主要充电站点
4. 导出CSV进行更深入分析

### 数据备份
1. 定期备份到iCloud
2. 更换设备时，从iCloud恢复
3. 重要数据同时导出CSV作为二次备份

## 🎯 路线图

### v1.1 计划功能
- [ ] 推送通知提醒
- [ ] Widget小组件
- [ ] 充电成本对比分析
- [ ] 更多充电平台支持
- [ ] 数据可视化增强

### v1.2 计划功能
- [ ] Apple Watch支持
- [ ] Siri快捷指令
- [ ] 充电地图导航
- [ ] 社区分享功能

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📄 开源协议

MIT License

## 👨‍💻 开发者

Zhou Ao

## 📮 联系方式

如有问题或建议，欢迎联系：
- Email: jimmy.zhou@outlook.com
- GitHub: https://github.com/zhouao2/ChargerNote

---

**Made with ❤️ for EV Drivers**

